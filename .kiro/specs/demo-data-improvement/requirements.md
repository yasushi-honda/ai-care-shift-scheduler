# Phase 43.1: デモデータ改善

**作成日**: 2025-12-07
**ステータス**: ✅ 完了（第3回修正）
**施設種別**: デイサービス（通所介護）定員20名

---

## 1. 概要

### 1.1 背景

当初のデモデータ（`seedDemoData.ts`）には以下の問題があった：

1. **データ形式の不一致**: AI生成エンジンが期待するフィールドが欠落
2. **数学的に不可能な人員配置**: 必要人日数 > 可能人日数
3. **施設種別の誤り**: 夜勤ありの入居施設設計だったが、**デイサービスには夜勤がない**

### 1.2 目的

- デモ環境でAIシフト生成が**成功する**データ構造に修正
- **デイサービス（通所介護）の実態**に即したリアルなデモデータを提供
- 新規ユーザーが機能を体験できる状態にする

### 1.3 成果

✅ **第3回修正完了**: 2025-12-07にデイサービス実態に即したデータをデプロイ済み
✅ **夜勤削除**: デイサービスは日中のみ営業のため夜勤シフトを廃止
✅ **人員配置最適化**: 法定基準（定員20名）に準拠した8名体制

---

## 2. 問題分析と修正履歴

### 2.1 第1回修正（データ形式）

| フィールド | 修正前 | 修正後 | 状態 |
|-----------|--------|--------|------|
| `weeklyWorkCount` | 存在しない | `{ hope: number; must: number }` | ✅ 修正済 |
| `availableWeekdays` | 存在しない | `number[]` | ✅ 修正済 |
| `timeSlots` | 存在しない | `ShiftTime[]` | ✅ 修正済 |
| `requirements` | 配列形式 | `Record<string, DailyRequirement>` | ✅ 修正済 |

### 2.2 第2回修正（数学的実現可能性）

問題: 1日8名必要だが10名では数学的に不可能

```text
必要人日数 = 31日 × 8名/日 = 248人日
可能人日数 = 10名 × 週4.5回 × 4.4週 ≒ 198人日
→ 約50人日（20%）不足
```

対策: シフトごとの人員を緩和（8名/日→5名/日）

### 2.3 第3回修正（施設種別の誤り ← 今回）

**根本的な設計ミス発覚**:

> デイサービスは**日中のみ営業**であり、**夜勤は存在しない**

Web調査により判明した事実:

| 項目 | 旧デモデータ | デイサービスの実態 |
|------|-------------|-------------------|
| 夜勤 | あり（夜勤専従2名） | **なし** |
| 営業時間 | 24時間体制 | 8:30〜18:00頃 |
| シフト種類 | 早番・日勤・遅番・夜勤 | 早番・日勤・遅番のみ |
| スタッフ数 | 10名 | 5〜8名程度 |

**参考資料**:

- [Shift Life - 通所介護の人員配置基準](https://shiftlife.jp/ds-kijun/)
- [カイポケ - 通所介護の人員基準](https://ads.kaipoke.biz/day-service/opening/post-93.html)
- [そよ風 - デイサービスのサービス提供時間](https://www.sykz.co.jp/media/day-service-time/)

---

## 3. デイサービス人員配置基準（法定）

### 3.1 厚生労働省の人員配置基準（定員20名）

| 職種 | 必要人数 | 備考 |
|------|---------|------|
| 管理者 | 1名（常勤） | 他職種と兼務可 |
| 生活相談員 | 1名以上 | 管理者と兼務可 |
| 看護職員 | 1名以上 | 法定基準 |
| 介護職員 | 2名以上 | (20-15)÷5+1=2 |
| 機能訓練指導員 | 1名以上 | PT/OT/柔道整復師等 |

### 3.2 介護職員の計算式

```text
定員16名以上の場合:
必要介護職員数 = (利用者数 - 15) ÷ 5 + 1

定員20名の場合:
(20 - 15) ÷ 5 + 1 = 2名以上
```

---

## 4. 修正後のデモデータ設計

### 4.1 施設設定

- **施設名**: サンプル介護施設
- **施設種別**: デイサービス（通所介護）
- **定員**: 20名
- **営業時間**: 8:00〜19:00（送迎含む）
- **営業日**: 月〜土（日曜休み）

### 4.2 スタッフ構成（8名）

| ID | 氏名 | 役職 | 資格 | 週勤務 | 勤務可能曜日 |
|----|------|------|------|--------|-------------|
| staff-tanaka | 田中太郎 | 管理者 | 介護福祉士, 生活相談員 | 5/4 | 月〜土 |
| staff-sato | 佐藤花子 | 看護職員 | 看護師 | 5/4 | 月〜土 |
| staff-suzuki | 鈴木美咲 | 看護職員 | 看護師 | 4/3 | 月〜土 |
| staff-takahashi | 高橋健太 | 介護職員 | 介護福祉士 | 5/4 | 月〜土 |
| staff-ito | 伊藤真理 | 介護職員 | 介護福祉士 | 5/4 | 月〜土 |
| staff-watanabe | 渡辺翔太 | 介護職員 | 介護職員初任者研修 | 5/4 | 月〜土 |
| staff-yamamoto | 山本さくら | 介護職員 | 介護職員初任者研修 | 4/3 | 月〜土 |
| staff-kondo | 近藤理恵 | 機能訓練指導員 | 理学療法士 | 5/4 | 月〜土 |

**法定基準との対応**:

- ✅ 管理者: 田中太郎（兼生活相談員）
- ✅ 看護職員: 佐藤花子、鈴木美咲（2名）
- ✅ 介護職員: 高橋、伊藤、渡辺、山本（4名 ≥ 2名）
- ✅ 機能訓練指導員: 近藤理恵

### 4.3 シフト要件（夜勤なし）

| シフト | 時間 | 必要人数 | 資格要件 |
|--------|------|----------|----------|
| 早番 | 08:00-17:00 | 2名 | なし（送迎要員） |
| 日勤 | 09:00-18:00 | 2名 | 看護師1名以上（法定） |
| 遅番 | 10:00-19:00 | 1名 | なし（送迎終了対応） |

### 4.4 数学的検証

```text
必要人日数 = 26日（月〜土）× 5名/日 = 130人日
可能人日数 = 8名 × 週4.5回平均 × 4週 ≒ 144人日
余裕率 = (144 - 130) / 130 ≒ 11%
```

✅ 数学的に実現可能

---

## 5. 変更対象ファイル

| ファイル | 変更内容 | 状態 |
|----------|----------|------|
| `scripts/seedDemoData.ts` | デイサービス実態に即した全面修正 | ✅ 完了 |
| `.kiro/specs/demo-data-improvement/requirements.md` | 本仕様書 | ✅ 完了 |
| `.kiro/specs/demo-data-improvement/simulation-analysis.md` | シミュレーション分析 | 📝 更新予定 |

---

## 6. テスト計画

### 6.1 論理検証（シミュレーション）

- [x] スタッフ構成と法定基準の整合性確認
- [x] 資格要件の充足可能性確認
- [x] 休暇申請を考慮した人員余裕の確認
- [x] 夜勤シフトが存在しないことを確認

### 6.2 実機テスト（手動）

- [ ] デモアカウントでログイン
- [ ] サンプル施設を選択
- [ ] シフト生成を実行
- [ ] 「この要件では実現不可能です」エラーが出ないことを確認
- [ ] シフト表が正常に生成されることを確認
- [ ] AI評価パネルが表示されることを確認

---

## 7. 学び・反省

### 7.1 根本原因

**施設種別の理解不足**: デイサービスと入居施設（特養・老健）の違いを把握せず、
夜勤シフトを含む設計をしていた。

### 7.2 教訓

1. **ドメイン知識の重要性**: 介護業界の基本的な施設種別・運営形態を理解する
2. **法定基準の確認**: 厚生労働省の人員配置基準を参照する
3. **Web調査の活用**: 不明点は専門サイトで確認する

### 7.3 今後の改善

- デモデータ作成時は施設種別を明確にする
- 法定基準との整合性をチェックリストで確認
- 介護業界の実務経験者によるレビューを検討

---

## 8. 承認

- [x] 要件レビュー完了
- [x] 実装完了（第3回修正）
- [x] デイサービス実態調査完了
- [ ] 実機テスト完了（次回セッションで実施予定）

---

## 変更履歴

| 日付 | 変更者 | 内容 |
|------|--------|------|
| 2025-12-07 | Claude | 初版作成 |
| 2025-12-07 | Claude | 第2回修正（人員数の数学的実現可能性） |
| 2025-12-07 | Claude | 第3回修正（デイサービス実態に即した全面改訂） |
