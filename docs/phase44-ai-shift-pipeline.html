<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phase 44: AIã‚·ãƒ•ãƒˆç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ”¹å–„</title>
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <style>
    :root {
      --primary: #2563eb;
      --secondary: #64748b;
      --success: #22c55e;
      --warning: #f59e0b;
      --danger: #ef4444;
      --bg: #f8fafc;
      --card-bg: #ffffff;
      --text: #1e293b;
      --border: #e2e8f0;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      padding: 1rem;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, var(--primary), #1d4ed8);
      color: white;
      border-radius: 12px;
    }

    header h1 {
      font-size: 1.75rem;
      margin-bottom: 0.5rem;
    }

    header p {
      opacity: 0.9;
      font-size: 0.95rem;
    }

    .status-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-top: 0.5rem;
    }

    .status-in-progress {
      background: var(--warning);
      color: white;
    }

    .nav-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
      border-bottom: 2px solid var(--border);
      padding-bottom: 0.5rem;
    }

    .nav-tab {
      padding: 0.5rem 1rem;
      border: none;
      background: transparent;
      cursor: pointer;
      font-size: 0.9rem;
      color: var(--secondary);
      border-radius: 8px 8px 0 0;
      transition: all 0.2s;
    }

    .nav-tab:hover {
      background: var(--border);
    }

    .nav-tab.active {
      background: var(--primary);
      color: white;
    }

    .section {
      display: none;
      background: var(--card-bg);
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin-bottom: 1.5rem;
    }

    .section.active {
      display: block;
    }

    .section h2 {
      font-size: 1.25rem;
      margin-bottom: 1rem;
      color: var(--primary);
      border-bottom: 2px solid var(--border);
      padding-bottom: 0.5rem;
    }

    .mermaid {
      background: white;
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      font-size: 0.9rem;
    }

    th, td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    th {
      background: var(--bg);
      font-weight: 600;
    }

    tr:hover {
      background: var(--bg);
    }

    .metric-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin: 1rem 0;
    }

    .metric-card {
      background: var(--bg);
      padding: 1rem;
      border-radius: 8px;
      text-align: center;
    }

    .metric-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--primary);
    }

    .metric-label {
      font-size: 0.85rem;
      color: var(--secondary);
    }

    .code-block {
      background: #1e293b;
      color: #e2e8f0;
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 0.85rem;
      margin: 1rem 0;
    }

    .timeline-item {
      display: flex;
      gap: 1rem;
      padding: 1rem 0;
      border-left: 3px solid var(--primary);
      padding-left: 1.5rem;
      margin-left: 0.5rem;
    }

    .timeline-item.completed {
      border-left-color: var(--success);
    }

    .timeline-item.in-progress {
      border-left-color: var(--warning);
    }

    .timeline-date {
      font-weight: 600;
      min-width: 80px;
    }

    .alert {
      padding: 1rem;
      border-radius: 8px;
      margin: 1rem 0;
    }

    .alert-info {
      background: #dbeafe;
      color: #1e40af;
    }

    .alert-warning {
      background: #fef3c7;
      color: #92400e;
    }

    .alert-success {
      background: #dcfce7;
      color: #166534;
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      header h1 {
        font-size: 1.25rem;
      }

      .nav-tabs {
        flex-direction: column;
      }

      .nav-tab {
        width: 100%;
        text-align: center;
      }

      .metric-grid {
        grid-template-columns: 1fr 1fr;
      }

      table {
        font-size: 0.8rem;
      }

      th, td {
        padding: 0.5rem;
      }

      .mermaid {
        font-size: 0.8rem;
      }
    }

    @media (max-width: 480px) {
      .metric-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Phase 44: AIã‚·ãƒ•ãƒˆç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ”¹å–„</h1>
      <p>Gemini 2.5 Flash ã«ã‚ˆã‚‹æ®µéšçš„ã‚·ãƒ•ãƒˆç”Ÿæˆã®æœ€é©åŒ–</p>
      <span class="status-badge status-in-progress" style="background: #22c55e;">95%å®Œäº† âœ…</span>
    </header>

    <nav class="nav-tabs">
      <button class="nav-tab active" onclick="showSection('overview')">æ¦‚è¦</button>
      <button class="nav-tab" onclick="showSection('results')">ãƒ†ã‚¹ãƒˆçµæœ</button>
      <button class="nav-tab" onclick="showSection('wbs')">WBS</button>
      <button class="nav-tab" onclick="showSection('gantt')">ã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆ</button>
      <button class="nav-tab" onclick="showSection('architecture')">ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ</button>
      <button class="nav-tab" onclick="showSection('flow')">å‡¦ç†ãƒ•ãƒ­ãƒ¼</button>
      <button class="nav-tab" onclick="showSection('data')">ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ</button>
      <button class="nav-tab" onclick="showSection('implementation')">å®Ÿè£…çŠ¶æ³</button>
    </nav>

    <!-- Overview Section -->
    <section id="overview" class="section active">
      <h2>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦</h2>

      <div class="metric-grid">
        <div class="metric-card">
          <div class="metric-value">5</div>
          <div class="metric-label">æ®µéšãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">100%</div>
          <div class="metric-label">ç›®æ¨™å……è¶³ç‡</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">Flash</div>
          <div class="metric-label">ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">8å</div>
          <div class="metric-label">ãƒ‡ãƒ¢ã‚¹ã‚¿ãƒƒãƒ•</div>
        </div>
      </div>

      <h3 style="margin-top: 1.5rem;">å•é¡Œã¨è§£æ±ºç­–</h3>
      <table>
        <thead>
          <tr>
            <th>å•é¡Œ</th>
            <th>åŸå› </th>
            <th>è§£æ±ºç­–</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>ã‚·ãƒ•ãƒˆé…åˆ†ãŒä¸å‡ç­‰</td>
            <td>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«å…·ä½“çš„äººå“¡æ•°ãŒãªã„</td>
            <td>å¿…è¦äººå“¡ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ˜ç¤ºçš„ã«è¨˜è¼‰</td>
          </tr>
          <tr>
            <td>æ—¥å˜ä½ã®æœ€é©åŒ–ä¸å¯</td>
            <td>ã‚¹ã‚¿ãƒƒãƒ•è»¸ãƒãƒƒãƒå‡¦ç†</td>
            <td>é€±å˜ä½ï¼ˆæ—¥ä»˜è»¸ï¼‰å‡¦ç†ã«å¤‰æ›´</td>
          </tr>
          <tr>
            <td>å…¨ä½“æœ€é©åŒ–ãŒå›°é›£</td>
            <td>ãƒãƒƒãƒé–“ã®æƒ…å ±åˆ†æ–­</td>
            <td>5æ®µéšãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§æ®µéšçš„æœ€é©åŒ–</td>
          </tr>
        </tbody>
      </table>

      <div class="alert alert-success">
        <strong>æˆæœ:</strong> å‹•çš„ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåˆ¶ç´„ã¨timeSlotPreferenceé•åæ¤œå‡ºã‚’å®Ÿè£…ã€‚å……è¶³ç‡ãŒ96%â†’98%ã«æ”¹å–„ã€timeSlotPreferenceé•å0ä»¶é”æˆã€‚
      </div>
    </section>

    <!-- Test Results Section -->
    <section id="results" class="section">
      <h2>ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼</h2>

      <div class="metric-grid">
        <div class="metric-card">
          <div class="metric-value" style="color: #22c55e;">98%</div>
          <div class="metric-label">å……è¶³ç‡</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">3ä»¶</div>
          <div class="metric-label">åˆ¶ç´„é•å</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">180ç§’</div>
          <div class="metric-label">å‡¦ç†æ™‚é–“</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">0ä»¶</div>
          <div class="metric-label">timeSlotPreferenceé•å</div>
        </div>
      </div>

      <h3 style="margin-top: 1.5rem;">ãƒ†ã‚¹ãƒˆçµæœã®æ¨ç§»</h3>
      <div class="mermaid">
xychart-beta
    title "å……è¶³ç‡ã®æ¨ç§»"
    x-axis ["Step 1", "Step 1.5", "ãƒ‡ãƒ¼ã‚¿ä¿®æ­£å¾Œ", "å‹•çš„åˆ¶ç´„å®Ÿè£…å¾Œ"]
    y-axis "å……è¶³ç‡ (%)" 0 --> 100
    bar [85, 89, 96, 98]
      </div>

      <h3 style="margin-top: 1.5rem;">è©³ç´°æ¯”è¼ƒ</h3>
      <table>
        <thead>
          <tr>
            <th>æŒ‡æ¨™</th>
            <th>Step 1</th>
            <th>Step 1.5</th>
            <th>ãƒ‡ãƒ¼ã‚¿ä¿®æ­£å¾Œ</th>
            <th>å‹•çš„åˆ¶ç´„å®Ÿè£…å¾Œ</th>
            <th>ç›®æ¨™</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>å……è¶³ç‡</td>
            <td>85%</td>
            <td>89%</td>
            <td>96%</td>
            <td style="color: #22c55e; font-weight: bold;">98% âœ…</td>
            <td>100%</td>
          </tr>
          <tr>
            <td>æ—©ç•ªä¸è¶³</td>
            <td>17æ—¥</td>
            <td>15æ—¥</td>
            <td>2æ—¥</td>
            <td style="color: #22c55e; font-weight: bold;">3æ—¥</td>
            <td>0æ—¥</td>
          </tr>
          <tr>
            <td>é…ç•ªä¸è¶³</td>
            <td>3æ—¥</td>
            <td>0æ—¥</td>
            <td>0æ—¥ âœ…</td>
            <td style="color: #22c55e; font-weight: bold;">0æ—¥ âœ…</td>
            <td>0æ—¥</td>
          </tr>
          <tr>
            <td>åˆ¶ç´„é•å</td>
            <td>21ä»¶</td>
            <td>18ä»¶</td>
            <td>13ä»¶</td>
            <td style="color: #22c55e; font-weight: bold;">3ä»¶ (-75%)</td>
            <td>0ä»¶</td>
          </tr>
          <tr>
            <td>timeSlotPreferenceé•å</td>
            <td>-</td>
            <td>-</td>
            <td>ã‚ã‚Š</td>
            <td style="color: #22c55e; font-weight: bold;">ãªã— âœ…</td>
            <td>ãªã—</td>
          </tr>
        </tbody>
      </table>

      <div class="alert alert-warning" style="margin-top: 1.5rem;">
        <strong>ç™ºè¦‹ã—ãŸæ ¹æœ¬åŸå› :</strong><br>
        ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã§ã€Œæ—¥å‹¤ã®ã¿ã€ã‚¹ã‚¿ãƒƒãƒ•ãŒ2åï¼ˆç”°ä¸­ãƒ»è¿‘è—¤ï¼‰ã„ãŸãŸã‚ã€æ—¥å‹¤ã«äººå“¡ãŒåã‚Šã€æ—©ç•ªãƒ»é…ç•ªãŒä¸è¶³ã—ã¦ã„ãŸã€‚<br>
        è¿‘è—¤ã®åˆ¶ç´„ã‚’ã€Œã„ã¤ã§ã‚‚å¯ã€ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€æ•°å­¦çš„ã«åˆ¶ç´„ã‚’æº€ãŸã›ã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚
      </div>

      <h3 style="margin-top: 1.5rem;">ã‚·ãƒ•ãƒˆé…åˆ†ã®å¤‰åŒ–</h3>
      <div class="mermaid">
pie title ãƒ‡ãƒ¼ã‚¿ä¿®æ­£å¾Œã®ã‚·ãƒ•ãƒˆé…åˆ†
    "æ—©ç•ª (55äººæ—¥)" : 55
    "æ—¥å‹¤ (62äººæ—¥)" : 62
    "é…ç•ª (27äººæ—¥)" : 27
      </div>
    </section>

    <!-- WBS Section -->
    <section id="wbs" class="section">
      <h2>WBSï¼ˆä½œæ¥­åˆ†è§£å›³ï¼‰</h2>

      <div class="mermaid">
graph TD
    A[Phase 44: AIã‚·ãƒ•ãƒˆç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ”¹å–„] --> B[Step 1: ã‚¯ã‚¤ãƒƒã‚¯ã‚¦ã‚£ãƒ³]
    A --> C[Step 2: é€±å˜ä½å‡¦ç†]
    A --> D[Step 3: 5æ®µéšãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³]

    B --> B1[ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ”¹å–„]
    B --> B2[ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼]
    B --> B3[Gitã‚³ãƒŸãƒƒãƒˆ]

    B1 --> B1a[å¿…è¦äººå“¡ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ ]
    B1 --> B1b[è³‡æ ¼è¦ä»¶ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ]
    B1 --> B1c[ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè¿½åŠ ]

    C --> C1[phase3-weekly.tsä½œæˆ]
    C --> C2[é€±åˆ†å‰²ãƒ­ã‚¸ãƒƒã‚¯]
    C --> C3[çµ±åˆãƒ†ã‚¹ãƒˆ]
    C --> C4[Gitã‚³ãƒŸãƒƒãƒˆ]

    D --> D1[Phase 1: è¦ä»¶åˆ†æ]
    D --> D2[Phase 2: éª¨å­è¨­è¨ˆ]
    D --> D3[Phase 3: é€±åˆ¥é…ç½®]
    D --> D4[Phase 4: æ•´åˆæ€§æ¤œè¨¼]
    D --> D5[Phase 4.1: èª¿æ•´]
    D --> D6[Phase 5: æœ€çµ‚å‡ºåŠ›]

    style A fill:#2563eb,color:#fff
    style B fill:#22c55e,color:#fff
    style C fill:#f59e0b,color:#fff
    style D fill:#64748b,color:#fff
      </div>

      <h3 style="margin-top: 1.5rem;">ã‚¿ã‚¹ã‚¯è©³ç´°</h3>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>ã‚¿ã‚¹ã‚¯</th>
            <th>å„ªå…ˆåº¦</th>
            <th>è¦‹ç©ã‚‚ã‚Š</th>
            <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1.1</td>
            <td>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«å¿…è¦äººå“¡ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ </td>
            <td>æœ€é«˜</td>
            <td>30åˆ†</td>
            <td>ğŸ”„ å®Ÿè£…ä¸­</td>
          </tr>
          <tr>
            <td>1.2</td>
            <td>è³‡æ ¼è¦ä»¶ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé–¢æ•°è¿½åŠ </td>
            <td>é«˜</td>
            <td>15åˆ†</td>
            <td>â³ å¾…æ©Ÿ</td>
          </tr>
          <tr>
            <td>1.3</td>
            <td>ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ»æ¤œè¨¼</td>
            <td>é«˜</td>
            <td>30åˆ†</td>
            <td>â³ å¾…æ©Ÿ</td>
          </tr>
          <tr>
            <td>2.1</td>
            <td>é€±å˜ä½å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…</td>
            <td>é«˜</td>
            <td>2æ™‚é–“</td>
            <td>â³ å¾…æ©Ÿ</td>
          </tr>
          <tr>
            <td>2.2</td>
            <td>çµ±åˆãƒ†ã‚¹ãƒˆ</td>
            <td>é«˜</td>
            <td>1æ™‚é–“</td>
            <td>â³ å¾…æ©Ÿ</td>
          </tr>
          <tr>
            <td>3.1</td>
            <td>5æ®µéšãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè£…</td>
            <td>ä¸­</td>
            <td>4æ™‚é–“</td>
            <td>â³ å¾…æ©Ÿ</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Gantt Section -->
    <section id="gantt" class="section">
      <h2>ã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰</h2>

      <div class="mermaid">
gantt
    title Phase 44 å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
    dateFormat  YYYY-MM-DD

    section Step 1: ã‚¯ã‚¤ãƒƒã‚¯ã‚¦ã‚£ãƒ³
    ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ           :done,    doc1, 2025-12-07, 1d
    ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ”¹å–„             :active,  s1a, 2025-12-07, 1d
    ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼               :         s1b, after s1a, 1d

    section Step 2: é€±å˜ä½å‡¦ç†
    é€±å˜ä½å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯         :         s2a, 2025-12-08, 1d
    çµ±åˆãƒ†ã‚¹ãƒˆ                 :         s2b, after s2a, 1d

    section Step 3: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
    Phase 1-2 å®Ÿè£…             :         s3a, 2025-12-09, 1d
    Phase 3-5 å®Ÿè£…             :         s3b, after s3a, 1d
    æœ€çµ‚æ¤œè¨¼ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤         :         s3c, after s3b, 1d
      </div>

      <h3 style="margin-top: 1.5rem;">ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³</h3>
      <div class="timeline-item completed">
        <span class="timeline-date">12/7 AM</span>
        <div>
          <strong>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¼šè­°ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ</strong>
          <p>è­°äº‹éŒ²ã€æŠ€è¡“ä»•æ§˜æ›¸ã€å®Ÿè£…è¨ˆç”»æ›¸ã‚’ä½œæˆå®Œäº†</p>
        </div>
      </div>
      <div class="timeline-item in-progress">
        <span class="timeline-date">12/7 PM</span>
        <div>
          <strong>Step 1: ã‚¯ã‚¤ãƒƒã‚¯ã‚¦ã‚£ãƒ³å®Ÿè£…</strong>
          <p>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ”¹å–„ã«ã‚ˆã‚‹å³åŠ¹æ€§ã®ã‚ã‚‹æ”¹å–„</p>
        </div>
      </div>
      <div class="timeline-item">
        <span class="timeline-date">12/8</span>
        <div>
          <strong>Step 2: é€±å˜ä½å‡¦ç†</strong>
          <p>æ—¥ä»˜è»¸ãƒãƒƒãƒå‡¦ç†ã¸ã®ç§»è¡Œ</p>
        </div>
      </div>
      <div class="timeline-item">
        <span class="timeline-date">12/9</span>
        <div>
          <strong>Step 3: 5æ®µéšãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Œæˆ</strong>
          <p>å …ç‰¢ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å®Œæˆãƒ»æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤</p>
        </div>
      </div>
    </section>

    <!-- Architecture Section -->
    <section id="architecture" class="section">
      <h2>ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³</h2>

      <div class="mermaid">
graph TB
    subgraph "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå±¤"
        A[React SPA<br/>ShiftGenerationPage]
    end

    subgraph "APIå±¤"
        B[Cloud Functions<br/>generateShift]
    end

    subgraph "AI Pipeline"
        C[Phase 1<br/>è¦ä»¶åˆ†æ]
        D[Phase 2<br/>éª¨å­è¨­è¨ˆ]
        E[Phase 3<br/>é€±åˆ¥é…ç½®]
        F[Phase 4<br/>æ•´åˆæ€§æ¤œè¨¼]
        G[Phase 4.1<br/>èª¿æ•´]
        H[Phase 5<br/>æœ€çµ‚å‡ºåŠ›]
    end

    subgraph "å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹"
        I[Vertex AI<br/>Gemini 2.5 Flash]
    end

    subgraph "ãƒ‡ãƒ¼ã‚¿å±¤"
        J[(Firestore<br/>staff, requirements)]
        K[(Firestore<br/>schedules)]
    end

    A -->|POST /generateShift| B
    B --> C
    C -->|ConstraintMatrix| D
    D -->|SkeletonSchedule| E
    E -->|WeeklyShifts| F
    F -->|ValidationResult| G
    G -->|AdjustedShifts| F
    F -->|Valid| H
    H -->|FinalSchedule| B

    D -->|AI Call| I
    E -->|AI Call x é€±æ•°| I
    G -->|AI Call æ¡ä»¶ä»˜ã| I

    B -->|Read| J
    B -->|Write| K

    style C fill:#dbeafe
    style D fill:#fef3c7
    style E fill:#fef3c7
    style F fill:#dbeafe
    style G fill:#fef3c7
    style H fill:#dbeafe
      </div>

      <div class="alert alert-info">
        <strong>å‡¡ä¾‹:</strong>
        é’ = ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ï¼ˆé«˜é€Ÿãƒ»ç„¡æ–™ï¼‰ã€
        é»„ = AIå‡¦ç†ï¼ˆGemini APIå‘¼ã³å‡ºã—ï¼‰
      </div>

      <h3 style="margin-top: 1.5rem;">ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¸€è¦§</h3>
      <table>
        <thead>
          <tr>
            <th>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</th>
            <th>å½¹å‰²</th>
            <th>æŠ€è¡“</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>React SPA</td>
            <td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</td>
            <td>React 18, TypeScript, Vite</td>
          </tr>
          <tr>
            <td>Cloud Functions</td>
            <td>APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</td>
            <td>Node.js 18, Firebase Functions</td>
          </tr>
          <tr>
            <td>Vertex AI</td>
            <td>AIã‚·ãƒ•ãƒˆç”Ÿæˆ</td>
            <td>Gemini 2.5 Flash</td>
          </tr>
          <tr>
            <td>Firestore</td>
            <td>ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–</td>
            <td>NoSQL Document DB</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Flow Section -->
    <section id="flow" class="section">
      <h2>å‡¦ç†ãƒ•ãƒ­ãƒ¼å›³</h2>

      <div class="mermaid">
sequenceDiagram
    participant U as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant FE as React SPA
    participant CF as Cloud Functions
    participant P1 as Phase 1: åˆ†æ
    participant P2 as Phase 2: éª¨å­
    participant P3 as Phase 3: é€±åˆ¥
    participant P4 as Phase 4: æ¤œè¨¼
    participant AI as Gemini 2.5 Flash
    participant FS as Firestore

    U->>FE: ã‚·ãƒ•ãƒˆç”Ÿæˆãƒœã‚¿ãƒ³æŠ¼ä¸‹
    FE->>CF: POST /generateShift

    Note over CF,P1: Phase 1: è¦ä»¶åˆ†æï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
    CF->>P1: staffList, requirements
    P1->>P1: å–¶æ¥­æ—¥æŠ½å‡ºã€åˆ¶ç´„æ§‹ç¯‰
    P1-->>CF: ConstraintMatrix

    alt å®Ÿç¾ä¸å¯èƒ½
        CF-->>FE: error: äººå“¡ä¸è¶³
        FE-->>U: ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
    end

    Note over CF,AI: Phase 2: éª¨å­è¨­è¨ˆï¼ˆAIï¼‰
    CF->>P2: ConstraintMatrix
    P2->>AI: éª¨å­ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    AI-->>P2: SkeletonSchedule
    P2-->>CF: ä¼‘æ—¥ãƒ‘ã‚¿ãƒ¼ãƒ³

    Note over CF,AI: Phase 3: é€±åˆ¥é…ç½®ï¼ˆAI Ã— é€±æ•°ï¼‰
    loop å„é€±ï¼ˆ4-5é€±ï¼‰
        CF->>P3: week, skeleton
        P3->>AI: é€±åˆ¥é…ç½®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
        AI-->>P3: WeeklyShifts
        P3-->>CF: é€±ã®ã‚·ãƒ•ãƒˆ
    end

    Note over CF,P4: Phase 4: æ•´åˆæ€§æ¤œè¨¼ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
    CF->>P4: allWeeklyShifts
    P4->>P4: äººå“¡å……è¶³ã€è³‡æ ¼ã€é€£å‹¤ãƒã‚§ãƒƒã‚¯
    P4-->>CF: ValidationResult

    alt é•åã‚ã‚Š
        loop æœ€å¤§3å›
            CF->>AI: èª¿æ•´ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
            AI-->>CF: AdjustedShifts
            CF->>P4: å†æ¤œè¨¼
        end
    end

    Note over CF,FS: Phase 5: æœ€çµ‚å‡ºåŠ›
    CF->>FS: scheduleä¿å­˜
    CF-->>FE: success: schedule, evaluation
    FE-->>U: ã‚·ãƒ•ãƒˆè¡¨è¡¨ç¤º
      </div>

      <h3 style="margin-top: 1.5rem;">Phaseåˆ¥å‡¦ç†æ™‚é–“ï¼ˆè¦‹ç©ã‚‚ã‚Šï¼‰</h3>
      <table>
        <thead>
          <tr>
            <th>Phase</th>
            <th>å‡¦ç†</th>
            <th>æ‰€è¦æ™‚é–“</th>
            <th>APIå‘¼ã³å‡ºã—</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Phase 1</td>
            <td>è¦ä»¶åˆ†æ</td>
            <td>~100ms</td>
            <td>ãªã—</td>
          </tr>
          <tr>
            <td>Phase 2</td>
            <td>éª¨å­è¨­è¨ˆ</td>
            <td>~30ç§’</td>
            <td>1å›</td>
          </tr>
          <tr>
            <td>Phase 3</td>
            <td>é€±åˆ¥é…ç½®</td>
            <td>~2åˆ†</td>
            <td>4-5å›</td>
          </tr>
          <tr>
            <td>Phase 4</td>
            <td>æ•´åˆæ€§æ¤œè¨¼</td>
            <td>~100ms</td>
            <td>ãªã—</td>
          </tr>
          <tr>
            <td>Phase 4.1</td>
            <td>èª¿æ•´ï¼ˆæ¡ä»¶ä»˜ãï¼‰</td>
            <td>~30ç§’/å›</td>
            <td>0-3å›</td>
          </tr>
          <tr>
            <td>Phase 5</td>
            <td>æœ€çµ‚å‡ºåŠ›</td>
            <td>~100ms</td>
            <td>ãªã—</td>
          </tr>
          <tr style="font-weight: bold;">
            <td colspan="2">åˆè¨ˆ</td>
            <td>~3åˆ†</td>
            <td>5-9å›</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Data Section -->
    <section id="data" class="section">
      <h2>ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆï¼ˆERå›³ï¼‰</h2>

      <div class="mermaid">
erDiagram
    STAFF {
        string staffId PK
        string name
        string position
        array certifications
        object weeklyWorkCount
        array availableWeekdays
        array unavailableDates
        string timeSlotPreference
        boolean nightShiftOnly
        int maxConsecutiveDays
    }

    REQUIREMENT {
        string targetMonth
        array timeSlots
        object requirements
        timestamp updatedAt
    }

    LEAVE_REQUEST {
        string requestId PK
        string staffId FK
        string date
        string leaveType
    }

    CONSTRAINT_MATRIX {
        array businessDays
        object dailyRequirements
        object staffConstraints
        object feasibility
    }

    SKELETON_SCHEDULE {
        array staffSchedules
    }

    WEEKLY_SHIFTS {
        int weekNumber
        string startDate
        string endDate
        array dailyAssignments
    }

    FINAL_SCHEDULE {
        array schedule
        object evaluation
        object metadata
    }

    STAFF ||--o{ LEAVE_REQUEST : "has"
    STAFF }|--|| CONSTRAINT_MATRIX : "analyzed into"
    REQUIREMENT }|--|| CONSTRAINT_MATRIX : "analyzed into"
    CONSTRAINT_MATRIX ||--|| SKELETON_SCHEDULE : "generates"
    SKELETON_SCHEDULE ||--o{ WEEKLY_SHIFTS : "generates"
    WEEKLY_SHIFTS }|--|| FINAL_SCHEDULE : "combines into"
      </div>

      <h3 style="margin-top: 1.5rem;">ä¸»è¦ãƒ‡ãƒ¼ã‚¿æ§‹é€ </h3>

      <div class="code-block">
<pre>
// Phaseé–“ã®ãƒ‡ãƒ¼ã‚¿å—ã‘æ¸¡ã—

interface ConstraintMatrix {
  businessDays: string[];           // ['2026-01-05', ...]
  dailyRequirements: {
    [shiftType: string]: {
      totalStaff: number;
      qualifications: QualReq[];
    };
  };
  staffConstraints: {
    [staffId: string]: {
      availableDays: string[];
      preferredShifts: string[];
      qualifications: string[];
    };
  };
  feasibility: {
    isPossible: boolean;
    marginRate: number;
  };
}

interface WeeklyShifts {
  weekNumber: number;
  dailyAssignments: {
    date: string;
    æ—©ç•ª: string[];
    æ—¥å‹¤: string[];
    é…ç•ª: string[];
    ä¼‘: string[];
  }[];
}
</pre>
      </div>
    </section>

    <!-- Implementation Section -->
    <section id="implementation" class="section">
      <h2>å®Ÿè£…çŠ¶æ³</h2>

      <div class="alert alert-warning">
        <strong>ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:</strong> Step 1 (ã‚¯ã‚¤ãƒƒã‚¯ã‚¦ã‚£ãƒ³) å®Ÿè£…ä¸­
      </div>

      <h3>å¤‰æ›´å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«</h3>
      <table>
        <thead>
          <tr>
            <th>ãƒ•ã‚¡ã‚¤ãƒ«</th>
            <th>å¤‰æ›´å†…å®¹</th>
            <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>functions/src/phased-generation.ts</code></td>
            <td>buildDetailedPromptæ”¹å–„</td>
            <td>ğŸ”„ å®Ÿè£…ä¸­</td>
          </tr>
          <tr>
            <td><code>functions/src/pipeline/phase3-weekly.ts</code></td>
            <td>é€±å˜ä½å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæ–°è¦ï¼‰</td>
            <td>â³ Step 2</td>
          </tr>
          <tr>
            <td><code>functions/src/pipeline/phase1-analyze.ts</code></td>
            <td>è¦ä»¶åˆ†æãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæ–°è¦ï¼‰</td>
            <td>â³ Step 3</td>
          </tr>
          <tr>
            <td><code>functions/src/pipeline/phase4-validate.ts</code></td>
            <td>æ•´åˆæ€§æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæ–°è¦ï¼‰</td>
            <td>â³ Step 3</td>
          </tr>
        </tbody>
      </table>

      <h3 style="margin-top: 1.5rem;">Step 1: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ”¹å–„ï¼ˆå®Ÿè£…å†…å®¹ï¼‰</h3>
      <div class="code-block">
<pre>
// buildDetailedPrompt ã®æ”¹å–„ç‚¹

// 1. å¿…è¦äººå“¡ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
# ã€çµ¶å¯¾æ¡ä»¶ã€‘å„æ—¥ã®å¿…è¦äººå“¡
| ã‚·ãƒ•ãƒˆ | å¿…è¦äººæ•° | è³‡æ ¼è¦ä»¶ |
|--------|----------|----------|
| æ—©ç•ª   | 2å      | ãªã—     |
| æ—¥å‹¤   | 2å      | çœ‹è­·å¸«1åä»¥ä¸Š |
| é…ç•ª   | 1å      | ãªã—     |

// 2. è³‡æ ¼è¦ä»¶ã‚’æ˜ç¤º
- æ—¥å‹¤ã«ã¯çœ‹è­·å¸«ã‚’**å¿…ãš1åä»¥ä¸Š**é…ç½®ã™ã‚‹ã“ã¨

// 3. ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’è¿½åŠ 
# å‡ºåŠ›å‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
â–¡ å„æ—¥ã®æ—©ç•ªãŒ2åã„ã‚‹ã‹
â–¡ å„æ—¥ã®æ—¥å‹¤ãŒ2åã„ã‚‹ã‹ï¼ˆçœ‹è­·å¸«1åå«ã‚€ï¼‰
â–¡ å„æ—¥ã®é…ç•ªãŒ1åã„ã‚‹ã‹
</pre>
      </div>

      <h3 style="margin-top: 1.5rem;">æˆåŠŸåŸºæº–</h3>
      <div class="metric-grid">
        <div class="metric-card">
          <div class="metric-value">100%</div>
          <div class="metric-label">äººå“¡å……è¶³ç‡</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">0ä»¶</div>
          <div class="metric-label">åˆ¶ç´„é•å</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">5åˆ†</div>
          <div class="metric-label">å‡¦ç†æ™‚é–“ä¸Šé™</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">150%</div>
          <div class="metric-label">ã‚³ã‚¹ãƒˆä¸Šé™ï¼ˆå¯¾ç¾è¡Œæ¯”ï¼‰</div>
        </div>
      </div>
    </section>
  </div>

  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: 'default',
      securityLevel: 'loose'
    });

    function showSection(sectionId) {
      // Hide all sections
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));

      // Show selected section
      document.getElementById(sectionId).classList.add('active');
      event.target.classList.add('active');
    }
  </script>
</body>
</html>
