<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AIシフト自動作成システム - プロジェクト概要</title>
    <meta name="description" content="介護事業所向けAIシフト自動作成・管理システム">

    <!-- モバイル判定リダイレクト -->
    <script>
        try {
            const currentFile = window.location.pathname.split('/').pop();
            const isMobilePage = currentFile === 'mobile.html';
            if (window.innerWidth < 768 && !isMobilePage) {
                window.location.href = 'mobile.html';
            }
        } catch (e) {
            console.error('Mobile redirect failed:', e);
        }
    </script>

    <!-- Cayman Theme CSS -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style" type="text/css" crossorigin>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
            font-size: 16px;
            line-height: 1.5;
            color: #606c71;
        }
        .page-header {
            color: #fff;
            text-align: center;
            background-color: #155799;
            background-image: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #155799 100%);
            padding: 3rem 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .project-name {
            margin-top: 0;
            margin-bottom: 0.1rem;
            font-size: 2.25rem;
            font-weight: bold;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .project-tagline {
            margin-bottom: 2rem;
            font-weight: normal;
            opacity: 0.95;
            font-size: 1.25rem;
            color: #e8f4f8;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        .main-content {
            max-width: 64rem;
            padding: 2rem 1rem;
            margin: 0 auto;
            font-size: 1.1rem;
        }
        h1, h2, h3 {
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #0366d6;
        }
        h1 { font-size: 2rem; }
        h2 { font-size: 1.75rem; }
        h3 { font-size: 1.5rem; }
        hr {
            height: 2px;
            padding: 0;
            margin: 2rem 0;
            background-color: #eff0f1;
            border: 0;
        }
        a {
            color: #1e6bb8;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        strong {
            font-weight: bold;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }
        .feature-card {
            background: #f6f8fa;
            border: 1px solid #d1d5da;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }
        .feature-card h3 {
            margin-top: 0;
            color: #24292e;
            font-size: 1.2rem;
        }
        .feature-card p {
            margin: 0.5rem 0 0;
            color: #586069;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
        }
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        .mermaid {
            background: #f6f8fa;
            border: 1px solid #d1d5da;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            overflow-x: auto;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .mermaid:hover {
            box-shadow: 0 3px 8px rgba(0,0,0,0.15);
        }
        .mermaid svg {
            max-width: 100%;
            height: auto;
        }
        .mermaid-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
        }
        .mermaid-modal-content {
            margin: 2% auto;
            display: block;
            width: 95%;
            max-width: 95%;
            max-height: 90vh;
            background: white;
            padding: 2rem;
            border-radius: 8px;
            position: relative;
            overflow: auto;
        }
        .mermaid-modal-content svg {
            background: white;
            transition: transform 0.2s ease;
            cursor: move;
        }
        .zoom-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 0.5rem;
            z-index: 10000;
        }
        .zoom-btn {
            background: #0366d6;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 4px;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: background 0.2s;
        }
        .zoom-btn:hover {
            background: #0256c7;
        }
        .zoom-btn:active {
            transform: scale(0.95);
        }
        .zoom-level {
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-size: 14px;
            display: flex;
            align-items: center;
        }
        .mermaid-modal-close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        .mermaid-modal-close:hover {
            color: #bbb;
        }
        .zoom-hint {
            font-size: 0.9rem;
            color: #586069;
            font-style: italic;
            margin-top: 0.5rem;
            text-align: center;
        }
        .site-footer {
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: solid 1px #eff0f1;
            text-align: center;
            font-size: 0.9rem;
        }
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }
        .badge-done {
            background: #28a745;
            color: white;
        }
        .badge-planned {
            background: #6f42c1;
            color: white;
        }
    </style>

    <!-- Mermaid -->
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

      // Wait for DOM to be fully loaded
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initMermaid);
      } else {
        initMermaid();
      }

      function initMermaid() {
        mermaid.initialize({
          startOnLoad: true,
          theme: 'default',
          securityLevel: 'loose',
          flowchart: {
            useMaxWidth: false,
            htmlLabels: true
          },
          gantt: {
            useMaxWidth: false
          }
        });
        mermaid.run().then(() => {
          setupZoomableImages();
        });
      }

      function setupZoomableImages() {
        const modal = document.createElement('div');
        modal.className = 'mermaid-modal';
        modal.innerHTML = `
          <span class="mermaid-modal-close">&times;</span>
          <div class="mermaid-modal-content">
            <div class="zoom-controls">
              <button class="zoom-btn zoom-in" title="拡大">+</button>
              <button class="zoom-btn zoom-out" title="縮小">-</button>
              <button class="zoom-btn zoom-reset" title="リセット">&#8635;</button>
              <div class="zoom-level">100%</div>
            </div>
          </div>
        `;
        document.body.appendChild(modal);

        const closeBtn = modal.querySelector('.mermaid-modal-close');
        const modalContent = modal.querySelector('.mermaid-modal-content');
        const zoomInBtn = modal.querySelector('.zoom-in');
        const zoomOutBtn = modal.querySelector('.zoom-out');
        const zoomResetBtn = modal.querySelector('.zoom-reset');
        const zoomLevelDisplay = modal.querySelector('.zoom-level');

        let currentScale = 1;
        let currentSvg = null;
        let isDragging = false;
        let startX, startY, translateX = 0, translateY = 0;

        function updateZoom() {
          if (currentSvg) {
            currentSvg.style.transform = `scale(${currentScale}) translate(${translateX}px, ${translateY}px)`;
            zoomLevelDisplay.textContent = `${Math.round(currentScale * 100)}%`;
          }
        }

        function zoomIn() {
          currentScale = Math.min(currentScale + 0.2, 3);
          updateZoom();
        }

        function zoomOut() {
          currentScale = Math.max(currentScale - 0.2, 0.5);
          updateZoom();
        }

        function resetZoom() {
          currentScale = 1;
          translateX = 0;
          translateY = 0;
          updateZoom();
        }

        zoomInBtn.onclick = zoomIn;
        zoomOutBtn.onclick = zoomOut;
        zoomResetBtn.onclick = resetZoom;

        document.querySelectorAll('.mermaid').forEach(diagram => {
          diagram.addEventListener('click', function() {
            const svg = this.querySelector('svg');
            if (svg) {
              const controls = modalContent.querySelector('.zoom-controls');
              modalContent.innerHTML = '';
              modalContent.appendChild(controls);

              const clonedSvg = svg.cloneNode(true);
              clonedSvg.style.backgroundColor = 'white';

              const textElements = clonedSvg.querySelectorAll('text, .nodeLabel, .edgeLabel');
              textElements.forEach(el => {
                el.style.fill = '#000';
                el.style.color = '#000';
              });

              currentSvg = clonedSvg;
              currentScale = 1;
              translateX = 0;
              translateY = 0;

              clonedSvg.addEventListener('mousedown', (e) => {
                if (e.button === 0) {
                  isDragging = true;
                  startX = e.clientX - translateX;
                  startY = e.clientY - translateY;
                  clonedSvg.style.cursor = 'grabbing';
                }
              });

              document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                  translateX = e.clientX - startX;
                  translateY = e.clientY - startY;
                  updateZoom();
                }
              });

              document.addEventListener('mouseup', () => {
                if (isDragging) {
                  isDragging = false;
                  if (currentSvg) currentSvg.style.cursor = 'move';
                }
              });

              modalContent.appendChild(clonedSvg);
              modal.style.display = 'block';
              document.body.style.overflow = 'hidden';
              updateZoom();
            }
          });
        });

        closeBtn.onclick = () => {
          modal.style.display = 'none';
          document.body.style.overflow = '';
          resetZoom();
        };
        modal.onclick = (e) => {
          if (e.target === modal) {
            modal.style.display = 'none';
            document.body.style.overflow = '';
            resetZoom();
          }
        };
      }
    </script>
</head>
<body>
    <header class="page-header" role="banner">
        <h1 class="project-name">AIシフト自動作成システム</h1>
        <h2 class="project-tagline">介護事業所向け シフト管理・自動生成ソリューション</h2>
    </header>

    <main class="main-content" role="main">
        <h1>プロジェクト概要</h1>

        <p>介護・福祉事業所向けのAIシフト自動作成・管理システムです。Google Gemini AIを活用し、複雑な制約条件を考慮した最適なシフト表を自動生成します。</p>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">39</div>
                <div class="stat-label">完了フェーズ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">86%</div>
                <div class="stat-label">作業時間削減</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">2ヶ月</div>
                <div class="stat-label">開発期間</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">10+</div>
                <div class="stat-label">主要機能</div>
            </div>
        </div>

        <hr>

        <h2>主要機能</h2>

        <div class="feature-grid">
            <div class="feature-card">
                <h3>AIシフト自動生成</h3>
                <p>Gemini AIが制約条件（連勤制限、夜勤後休息、資格要件等）を考慮して最適なシフトを自動生成</p>
            </div>
            <div class="feature-card">
                <h3>認証・権限管理</h3>
                <p>Firebase Authによるマルチテナント設計。Admin/Manager/Staffの3段階RBAC</p>
            </div>
            <div class="feature-card">
                <h3>実績入力効率化</h3>
                <p>「予定と同じ」ボタン、一括コピー機能で月間作業時間を86%削減</p>
            </div>
            <div class="feature-card">
                <h3>キーボード操作</h3>
                <p>Tab/Enter/矢印キー/PageUp/Down対応。アクセシビリティ向上</p>
            </div>
            <div class="feature-card">
                <h3>シフト種別カスタマイズ</h3>
                <p>事業所ごとにシフト種別（時間、休憩、色）を自由に設定可能</p>
            </div>
            <div class="feature-card">
                <h3>休暇残高管理</h3>
                <p>公休・有給の残高管理、繰越計算、残高調整機能</p>
            </div>
        </div>

        <hr>

        <h2>開発タイムライン</h2>

        <div class="mermaid">
timeline
    title AIシフト自動作成システム 開発タイムライン
    section 基盤構築（10月）
        Phase 0-6 : プロトタイプ開発
                  : 認証・マルチテナント設計
        Phase 7-12 : UI/UX基盤
                   : Firestore設計
    section AI統合（11月前半）
        Phase 13-17 : Gemini API統合
                    : シフト生成AI
                    : 制約条件最適化
    section 改善・拡張（11月中旬）
        Phase 18-26 : 実績入力効率化
                    : E2Eテスト
                    : モバイル最適化
    section UX強化（11月後半）
        Phase 27-37 : ダブルクリック機能
                    : キーボードナビゲーション
                    : アンドゥ/リドゥ
        Phase 38-39 : シフト種別設定
                    : 休暇残高管理
    section 計画中（12月）
        Phase 40+ : レポート機能
                  : 通知機能
        </div>

        <hr>

        <h2>開発フェーズ詳細</h2>

        <div class="mermaid">
graph LR
    subgraph "Phase 0-12<br/>基盤構築"
        A1[認証・権限管理] --> A2[データ設計]
        A2 --> A3[UI/UX基盤]
    end

    subgraph "Phase 13-17<br/>AI統合"
        B1[Gemini API] --> B2[シフト生成AI]
        B2 --> B3[制約条件最適化]
    end

    subgraph "Phase 18-26<br/>改善・拡張"
        C1[実績入力効率化] --> C2[一括操作機能]
        C2 --> C3[E2Eテスト]
        C3 --> C4[モバイル最適化]
    end

    subgraph "Phase 27-37<br/>UX改善"
        D1[ダブルクリック] --> D2[キーボード操作]
        D2 --> D3[アンドゥ/リドゥ]
        D3 --> D4[アクセシビリティ]
    end

    subgraph "Phase 38-39<br/>設定管理"
        E1[シフト種別設定] --> E2[休暇残高管理]
    end

    A3 --> B1
    B3 --> C1
    C4 --> D1
    D4 --> E1

    style A1 fill:#E3F2FD
    style A2 fill:#E3F2FD
    style A3 fill:#E3F2FD
    style B1 fill:#FFF3E0
    style B2 fill:#FFF3E0
    style B3 fill:#FFF3E0
    style C1 fill:#E8F5E9
    style C2 fill:#E8F5E9
    style C3 fill:#E8F5E9
    style C4 fill:#E8F5E9
    style D1 fill:#F3E5F5
    style D2 fill:#F3E5F5
    style D3 fill:#F3E5F5
    style D4 fill:#F3E5F5
    style E1 fill:#FCE4EC
    style E2 fill:#FCE4EC
        </div>

        <hr>

        <h2>今後のロードマップ</h2>

        <div class="mermaid">
gantt
    title 2025年 開発ロードマップ
    dateFormat YYYY-MM-DD

    section 完了
    基盤構築（Phase 0-12）: done, phase1, 2025-10-23, 2025-11-05
    AI統合（Phase 13-17）: done, phase2, 2025-11-06, 2025-11-15
    改善1・2（Phase 18-25）: done, phase3, 2025-11-16, 2025-11-24
    E2E・モバイル（Phase 26）: done, phase4, 2025-11-24, 2d
    UX改善（Phase 27-37）: done, phase5, 2025-11-25, 2d
    設定管理（Phase 38-39）: done, phase6, 2025-11-26, 1d

    section 計画中（12月）
    レポート機能強化: phase7, 2025-12-01, 10d
    通知機能追加: phase8, 2025-12-11, 10d
        </div>

        <h3>将来の機能拡張候補（提案レベル）</h3>
        <ul>
            <li><strong>シフト表印刷最適化</strong> - 優先度: 中</li>
            <li><strong>シフト承認ワークフロー</strong> - 優先度: 中</li>
            <li><strong>有給取得率レポート</strong> - 優先度: 中</li>
            <li><strong>多言語対応（i18n）</strong> - 優先度: 低</li>
            <li><strong>ダークモード</strong> - 優先度: 低</li>
            <li><strong>Google Calendar連携</strong> - 優先度: 低（複雑性を考慮）</li>
        </ul>

        <hr>

        <h2>効率化の成果</h2>

        <div class="mermaid">
graph TB
    Start[実績入力の課題<br/>月間50分の作業]

    Start --> Phase1[改善1: 予定と同じボタン<br/><span class='badge badge-done'>完了</span>]
    Start --> Phase2[改善2: 一括コピー機能<br/><span class='badge badge-done'>完了</span>]
    Start --> Phase3[改善3: ダブルクリック機能<br/><span class='badge badge-done'>完了</span>]
    Start --> Phase4[改善4: キーボード操作<br/><span class='badge badge-done'>完了</span>]

    Phase1 --> Result1[効果: 50%削減<br/>25分/月]
    Phase2 --> Result2[効果: 86%削減<br/>7分/月]
    Phase3 --> Result3[効果: 高速操作]
    Phase4 --> Result4[効果: アクセシビリティ向上]

    style Phase1 fill:#90EE90
    style Phase2 fill:#90EE90
    style Phase3 fill:#90EE90
    style Phase4 fill:#90EE90
    style Result1 fill:#E8F5E9
    style Result2 fill:#E8F5E9
    style Result3 fill:#E8F5E9
    style Result4 fill:#E8F5E9
        </div>

        <hr>

        <h2>技術スタック</h2>

        <div class="mermaid">
graph TB
    subgraph "フロントエンド"
        FE1[React 19]
        FE2[TypeScript]
        FE3[Vite]
        FE4[TailwindCSS]
    end

    subgraph "バックエンド"
        BE1[Firebase Auth]
        BE2[Cloud Firestore]
        BE3[Cloud Functions]
        BE4[Firebase Hosting]
    end

    subgraph "AI"
        AI1[Google Gemini API]
        AI2[gemini-2.5-flash]
    end

    subgraph "テスト・CI/CD"
        T1[Vitest]
        T2[Playwright E2E]
        T3[GitHub Actions]
        T4[CodeRabbit]
    end

    style FE1 fill:#61DAFB
    style FE2 fill:#3178C6
    style FE3 fill:#646CFF
    style FE4 fill:#38BDF8
    style BE1 fill:#FFCA28
    style BE2 fill:#FFCA28
    style BE3 fill:#FFCA28
    style BE4 fill:#FFCA28
    style AI1 fill:#8E75B2
    style AI2 fill:#8E75B2
    style T1 fill:#729B1B
    style T2 fill:#2EAD33
    style T3 fill:#2088FF
    style T4 fill:#FF6B6B
        </div>

        <hr>

        <h2>本番環境・ドキュメント</h2>

        <p><strong>本番アプリ</strong>: <a href="https://ai-care-shift-scheduler.web.app" target="_blank">ai-care-shift-scheduler.web.app</a></p>
        <p><strong>技術ドキュメント</strong>: <a href="technical.html">開発者向け詳細（WBS・ER図・フロー図）</a></p>
        <p><strong>GitHub</strong>: <a href="https://github.com/yasushi-honda/ai-care-shift-scheduler" target="_blank">リポジトリ</a></p>

        <hr>

        <footer class="site-footer">
            <p><strong>最終更新</strong>: 2025年11月26日（Phase 39完了時点）</p>
        </footer>
    </main>
</body>
</html>
