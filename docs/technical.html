<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>技術ドキュメント - AIシフト自動作成システム</title>
    <meta name="description" content="開発者向け技術ドキュメント - WBS、ER図、システム構成図、フロー図">

    <!-- モバイル判定リダイレクト -->
    <script>
        try {
            const currentFile = window.location.pathname.split('/').pop();
            const isMobilePage = currentFile === 'technical-mobile.html';
            if (window.innerWidth < 768 && !isMobilePage) {
                window.location.href = 'technical-mobile.html';
            }
        } catch (e) {
            console.error('Mobile redirect failed:', e);
        }
    </script>

    <!-- Cayman Theme CSS -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style" type="text/css" crossorigin>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
            font-size: 16px;
            line-height: 1.5;
            color: #606c71;
        }
        .page-header {
            color: #fff;
            text-align: center;
            background-color: #155799;
            background-image: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #155799 100%);
            padding: 3rem 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .project-name {
            margin-top: 0;
            margin-bottom: 0.1rem;
            font-size: 2.25rem;
            font-weight: bold;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .project-tagline {
            margin-bottom: 2rem;
            font-weight: normal;
            opacity: 0.95;
            font-size: 1.25rem;
            color: #e8f4f8;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        .main-content {
            max-width: 72rem;
            padding: 2rem 1rem;
            margin: 0 auto;
            font-size: 1.1rem;
        }
        h1, h2, h3 {
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #0366d6;
        }
        h1 { font-size: 2rem; }
        h2 { font-size: 1.75rem; }
        h3 { font-size: 1.5rem; }
        hr {
            height: 2px;
            padding: 0;
            margin: 2rem 0;
            background-color: #eff0f1;
            border: 0;
        }
        a {
            color: #1e6bb8;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        strong {
            font-weight: bold;
        }
        .toc {
            background: #f6f8fa;
            border: 1px solid #d1d5da;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        .toc h3 {
            margin-top: 0;
            color: #24292e;
        }
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        .toc li {
            margin: 0.5rem 0;
        }
        .mermaid {
            background: #f6f8fa;
            border: 1px solid #d1d5da;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            overflow-x: auto;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .mermaid:hover {
            box-shadow: 0 3px 8px rgba(0,0,0,0.15);
        }
        .mermaid svg {
            max-width: 100%;
            height: auto;
        }
        .mermaid-large {
            overflow-x: scroll;
            max-width: 100%;
        }
        .mermaid-large svg {
            min-width: 1200px;
        }
        .mermaid-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
        }
        .mermaid-modal-content {
            margin: 2% auto;
            display: block;
            width: 95%;
            max-width: 95%;
            max-height: 90vh;
            background: white;
            padding: 2rem;
            border-radius: 8px;
            position: relative;
            overflow: auto;
        }
        .mermaid-modal-content svg {
            background: white;
            transition: transform 0.2s ease;
            cursor: move;
        }
        .zoom-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 0.5rem;
            z-index: 10000;
        }
        .zoom-btn {
            background: #0366d6;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 4px;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: background 0.2s;
        }
        .zoom-btn:hover {
            background: #0256c7;
        }
        .zoom-btn:active {
            transform: scale(0.95);
        }
        .zoom-level {
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-size: 14px;
            display: flex;
            align-items: center;
        }
        .mermaid-modal-close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        .mermaid-modal-close:hover {
            color: #bbb;
        }
        .zoom-hint {
            font-size: 0.9rem;
            color: #586069;
            font-style: italic;
            margin-top: 0.5rem;
            text-align: center;
        }
        .site-footer {
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: solid 1px #eff0f1;
            text-align: center;
            font-size: 0.9rem;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 1rem 0;
        }
        th, td {
            border: 1px solid #d1d5da;
            padding: 0.75rem;
            text-align: left;
        }
        th {
            background: #f6f8fa;
            font-weight: 600;
        }
        code {
            background: #f6f8fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>

    <!-- Mermaid -->
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initMermaid);
      } else {
        initMermaid();
      }

      function initMermaid() {
        mermaid.initialize({
          startOnLoad: true,
          theme: 'default',
          securityLevel: 'loose',
          flowchart: {
            useMaxWidth: false,
            htmlLabels: true,
            nodeSpacing: 80,
            rankSpacing: 80
          },
          gantt: {
            useMaxWidth: false
          },
          er: {
            useMaxWidth: false
          }
        });
        mermaid.run().then(() => {
          setupZoomableImages();
        });
      }

      function setupZoomableImages() {
        const modal = document.createElement('div');
        modal.className = 'mermaid-modal';
        modal.innerHTML = `
          <span class="mermaid-modal-close">&times;</span>
          <div class="mermaid-modal-content">
            <div class="zoom-controls">
              <button class="zoom-btn zoom-in" title="拡大">+</button>
              <button class="zoom-btn zoom-out" title="縮小">-</button>
              <button class="zoom-btn zoom-reset" title="リセット">&#8635;</button>
              <div class="zoom-level">100%</div>
            </div>
          </div>
        `;
        document.body.appendChild(modal);

        const closeBtn = modal.querySelector('.mermaid-modal-close');
        const modalContent = modal.querySelector('.mermaid-modal-content');
        const zoomInBtn = modal.querySelector('.zoom-in');
        const zoomOutBtn = modal.querySelector('.zoom-out');
        const zoomResetBtn = modal.querySelector('.zoom-reset');
        const zoomLevelDisplay = modal.querySelector('.zoom-level');

        let currentScale = 1;
        let currentSvg = null;
        let isDragging = false;
        let startX, startY, translateX = 0, translateY = 0;

        function updateZoom() {
          if (currentSvg) {
            currentSvg.style.transform = `scale(${currentScale}) translate(${translateX}px, ${translateY}px)`;
            zoomLevelDisplay.textContent = `${Math.round(currentScale * 100)}%`;
          }
        }

        function zoomIn() {
          currentScale = Math.min(currentScale + 0.2, 3);
          updateZoom();
        }

        function zoomOut() {
          currentScale = Math.max(currentScale - 0.2, 0.5);
          updateZoom();
        }

        function resetZoom() {
          currentScale = 1;
          translateX = 0;
          translateY = 0;
          updateZoom();
        }

        zoomInBtn.onclick = zoomIn;
        zoomOutBtn.onclick = zoomOut;
        zoomResetBtn.onclick = resetZoom;

        document.querySelectorAll('.mermaid').forEach(diagram => {
          diagram.addEventListener('click', function() {
            const svg = this.querySelector('svg');
            if (svg) {
              const controls = modalContent.querySelector('.zoom-controls');
              modalContent.innerHTML = '';
              modalContent.appendChild(controls);

              const clonedSvg = svg.cloneNode(true);
              clonedSvg.style.backgroundColor = 'white';

              const textElements = clonedSvg.querySelectorAll('text, .nodeLabel, .edgeLabel');
              textElements.forEach(el => {
                el.style.fill = '#000';
                el.style.color = '#000';
              });

              currentSvg = clonedSvg;
              currentScale = 1;
              translateX = 0;
              translateY = 0;

              clonedSvg.addEventListener('mousedown', (e) => {
                if (e.button === 0) {
                  isDragging = true;
                  startX = e.clientX - translateX;
                  startY = e.clientY - translateY;
                  clonedSvg.style.cursor = 'grabbing';
                }
              });

              document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                  translateX = e.clientX - startX;
                  translateY = e.clientY - startY;
                  updateZoom();
                }
              });

              document.addEventListener('mouseup', () => {
                if (isDragging) {
                  isDragging = false;
                  if (currentSvg) currentSvg.style.cursor = 'move';
                }
              });

              modalContent.appendChild(clonedSvg);
              modal.style.display = 'block';
              document.body.style.overflow = 'hidden';
              updateZoom();
            }
          });
        });

        closeBtn.onclick = () => {
          modal.style.display = 'none';
          document.body.style.overflow = '';
          resetZoom();
        };
        modal.onclick = (e) => {
          if (e.target === modal) {
            modal.style.display = 'none';
            document.body.style.overflow = '';
            resetZoom();
          }
        };
      }
    </script>
</head>
<body>
    <header class="page-header" role="banner">
        <h1 class="project-name">技術ドキュメント</h1>
        <h2 class="project-tagline">AIシフト自動作成システム - 開発者向け</h2>
    </header>

    <main class="main-content" role="main">
        <h1>技術ドキュメント（開発者向け）</h1>

        <p>Phase 39まで完了したAIシフト自動作成システムの技術詳細です。WBS、ER図、システム構成図、フロー図を含みます。</p>

        <div class="toc">
            <h3>目次</h3>
            <ul>
                <li><a href="#wbs">1. WBS（作業分解構造）</a></li>
                <li><a href="#gantt">2. ガントチャート</a></li>
                <li><a href="#architecture">3. システムアーキテクチャ</a></li>
                <li><a href="#er-diagram">4. ER図（データモデル）</a></li>
                <li><a href="#auth-flow">5. 認証フロー</a></li>
                <li><a href="#ai-flow">6. AIシフト生成フロー</a></li>
                <li><a href="#component">7. コンポーネント構成</a></li>
                <li><a href="#keyboard">8. キーボード操作フロー</a></li>
            </ul>
        </div>

        <hr>

        <h2 id="wbs">1. WBS（作業分解構造）</h2>

        <p>Phase 0-39の全作業を構造化した図です。</p>

        <div class="mermaid mermaid-large">
graph TB
    A[AIシフト自動作成システム<br/>Phase 0-39]

    A --> B[Phase 0-12<br/>基盤構築]
    A --> C[Phase 13-17<br/>AI統合]
    A --> D[Phase 18-26<br/>改善・拡張]
    A --> E[Phase 27-37<br/>UX改善]
    A --> F[Phase 38-39<br/>設定管理]

    B --> B1[認証・権限管理]
    B --> B2[Firestore設計]
    B --> B3[UI/UX基盤]

    B1 --> B1a[Firebase Auth]
    B1 --> B1b[RBAC実装]
    B1 --> B1c[マルチテナント]

    B2 --> B2a[コレクション設計]
    B2 --> B2b[セキュリティルール]
    B2 --> B2c[インデックス設定]

    C --> C1[Gemini API統合]
    C --> C2[シフト生成AI]
    C --> C3[制約条件最適化]

    C1 --> C1a[Cloud Functions]
    C1 --> C1b[APIキー管理]

    C2 --> C2a[プロンプト設計]
    C2 --> C2b[レスポンス解析]

    D --> D1[実績入力効率化]
    D --> D2[E2Eテスト]
    D --> D3[モバイル最適化]

    D1 --> D1a[予定と同じボタン]
    D1 --> D1b[一括コピー機能]

    E --> E1[ダブルクリック]
    E --> E2[キーボード操作]
    E --> E3[アンドゥ/リドゥ]
    E --> E4[ヘルプモーダル]

    E2 --> E2a[Tab/Enter]
    E2 --> E2b[矢印キー]
    E2 --> E2c[PageUp/Down]

    F --> F1[シフト種別設定]
    F --> F2[休暇残高管理]

    F1 --> F1a[カスタムシフト]
    F1 --> F1b[色設定]

    F2 --> F2a[公休残高]
    F2 --> F2b[有給残高]
    F2 --> F2c[繰越計算]

    style A fill:#E3F2FD
    style B fill:#BBDEFB
    style C fill:#FFF3E0
    style D fill:#E8F5E9
    style E fill:#F3E5F5
    style F fill:#FCE4EC
        </div>
        <p class="zoom-hint">図をクリックすると拡大表示されます</p>

        <hr>

        <h2 id="gantt">2. ガントチャート</h2>

        <div class="mermaid">
gantt
    title AIシフト自動作成システム 開発スケジュール
    dateFormat YYYY-MM-DD

    section Phase 0-12 基盤構築
    プロトタイプ: done, p0, 2025-10-23, 7d
    認証実装: done, p1, 2025-10-30, 3d
    Firestore設計: done, p2, 2025-11-02, 3d

    section Phase 13-17 AI統合
    Gemini API統合: done, p3, 2025-11-06, 5d
    シフト生成AI: done, p4, 2025-11-11, 4d

    section Phase 18-26 改善
    実績入力効率化: done, p5, 2025-11-16, 5d
    E2Eテスト: done, p6, 2025-11-21, 2d
    モバイル最適化: done, p7, 2025-11-23, 2d

    section Phase 27-37 UX
    ダブルクリック: done, p8, 2025-11-25, 1d
    キーボード操作: done, p9, 2025-11-25, 1d
    アンドゥ/リドゥ: done, p10, 2025-11-25, 1d

    section Phase 38-39 設定
    シフト種別設定: done, p11, 2025-11-26, 1d
    休暇残高管理: done, p12, 2025-11-26, 1d
        </div>

        <hr>

        <h2 id="architecture">3. システムアーキテクチャ</h2>

        <div class="mermaid">
graph TB
    subgraph "クライアント層"
        U[ユーザー<br/>ブラウザ]
        M[モバイル<br/>レスポンシブ]
    end

    subgraph "フロントエンド"
        R[React 19 + TypeScript]
        V[Vite Dev Server]
        T[TailwindCSS]
    end

    subgraph "Firebase"
        FA[Firebase Auth]
        FS[Cloud Firestore]
        FC[Cloud Functions]
        FH[Firebase Hosting]
    end

    subgraph "外部サービス"
        G[Vertex AI<br/>Gemini 2.5 Flash<br/>asia-northeast1]
    end

    subgraph "CI/CD"
        GH[GitHub Actions]
        CR[CodeRabbit]
        GP[GitHub Pages]
    end

    U --> FH
    M --> FH
    FH --> R
    R --> FA
    R --> FS
    R --> FC
    FC --> G

    GH --> FH
    GH --> GP
    CR --> GH

    style U fill:#E6F3FF
    style M fill:#E6F3FF
    style R fill:#61DAFB
    style FA fill:#FFCA28
    style FS fill:#FFCA28
    style FC fill:#FFCA28
    style FH fill:#FFCA28
    style G fill:#8E75B2
    style GH fill:#2088FF
        </div>

        <hr>

        <h2 id="er-diagram">4. ER図（データモデル）</h2>

        <p>Firestoreのコレクション構造を表現したER図です。</p>

        <div class="mermaid">
erDiagram
    USERS ||--o{ FACILITIES : "manages"
    FACILITIES ||--|{ STAFF : "contains"
    FACILITIES ||--|{ SCHEDULES : "has"
    FACILITIES ||--o{ LEAVE_REQUESTS : "has"
    FACILITIES ||--o| SHIFT_SETTINGS : "has"
    FACILITIES ||--o| LEAVE_SETTINGS : "has"
    FACILITIES ||--|{ LEAVE_BALANCES : "tracks"
    STAFF ||--o{ LEAVE_REQUESTS : "submits"
    STAFF ||--o{ LEAVE_BALANCES : "has"

    USERS {
        string uid PK
        string email
        string displayName
        string role "admin|manager|staff"
        array facilities
        timestamp createdAt
    }

    FACILITIES {
        string id PK
        string name
        string address
        object settings
        timestamp createdAt
    }

    STAFF {
        string id PK
        string name
        string role "介護福祉士|看護師等"
        array qualifications
        object workPreferences
        boolean isNightShiftOnly
        boolean isActive
    }

    SCHEDULES {
        string id PK
        string yearMonth "2025-11"
        array staffSchedules
        timestamp updatedAt
        string updatedBy
    }

    LEAVE_REQUESTS {
        string id PK
        string staffId FK
        string date
        string leaveType "希望休|有給等"
        string status "pending|approved"
    }

    SHIFT_SETTINGS {
        string id PK "default"
        array shiftTypes
        array defaultShiftCycle
        timestamp updatedAt
    }

    LEAVE_SETTINGS {
        string id PK "default"
        object publicHoliday
        object paidLeave
        timestamp updatedAt
    }

    LEAVE_BALANCES {
        string id PK "yearMonth_staffId"
        string staffId FK
        string yearMonth
        object publicHolidayBalance
        object paidLeaveBalance
    }
        </div>

        <h3>コレクション構造</h3>

        <table>
            <tr>
                <th>パス</th>
                <th>説明</th>
            </tr>
            <tr>
                <td><code>/users/{uid}</code></td>
                <td>ユーザー情報、権限、所属事業所</td>
            </tr>
            <tr>
                <td><code>/facilities/{facilityId}</code></td>
                <td>事業所情報</td>
            </tr>
            <tr>
                <td><code>/facilities/{facilityId}/staff/{staffId}</code></td>
                <td>スタッフ情報（サブコレクション）</td>
            </tr>
            <tr>
                <td><code>/facilities/{facilityId}/schedules/{yearMonth}</code></td>
                <td>月間シフト（予定・実績）</td>
            </tr>
            <tr>
                <td><code>/facilities/{facilityId}/leaveRequests/{id}</code></td>
                <td>休暇申請</td>
            </tr>
            <tr>
                <td><code>/facilities/{facilityId}/shiftSettings/default</code></td>
                <td>シフト種別設定</td>
            </tr>
            <tr>
                <td><code>/facilities/{facilityId}/leaveSettings/default</code></td>
                <td>休暇設定</td>
            </tr>
            <tr>
                <td><code>/facilities/{facilityId}/leaveBalances/{yearMonth_staffId}</code></td>
                <td>休暇残高</td>
            </tr>
        </table>

        <hr>

        <h2 id="auth-flow">5. 認証フロー</h2>

        <div class="mermaid">
sequenceDiagram
    actor User as ユーザー
    participant App as React App
    participant Auth as Firebase Auth
    participant FS as Firestore
    participant Rules as Security Rules

    User->>App: ログイン画面表示
    App->>Auth: signInWithEmailAndPassword()
    Auth-->>App: UserCredential

    App->>FS: getDoc(users/{uid})
    FS->>Rules: セキュリティルール検証
    Rules-->>FS: 許可
    FS-->>App: User Document

    App->>App: ユーザー権限確認
    alt Admin
        App->>App: 全事業所アクセス
    else Manager
        App->>App: 所属事業所のみ
    else Staff
        App->>App: 閲覧のみ
    end

    App-->>User: ダッシュボード表示
        </div>

        <hr>

        <h2 id="ai-flow">6. AIシフト生成フロー</h2>

        <div class="mermaid">
sequenceDiagram
    actor Manager as 管理者
    participant App as React App
    participant CF as Cloud Functions
    participant Gemini as Gemini API
    participant FS as Firestore

    Manager->>App: AI生成ボタンクリック
    App->>App: 制約条件収集
    Note over App: スタッフ情報、休暇希望、<br/>必要人員体制

    App->>CF: generateShift(options)
    CF->>CF: プロンプト構築

    CF->>Gemini: generateContent()
    Note over Gemini: gemini-2.5-flash<br/>asia-northeast1（東京）

    Gemini-->>CF: JSON形式シフト

    CF->>CF: レスポンス検証
    alt 有効なJSON
        CF->>FS: シフト保存
        CF-->>App: success + シフトデータ
        App-->>Manager: シフト表表示
    else 無効なJSON
        CF-->>App: error
        App-->>Manager: エラーメッセージ
    end
        </div>

        <hr>

        <h2 id="component">7. コンポーネント構成</h2>

        <div class="mermaid">
graph TB
    subgraph "Pages"
        App[App.tsx<br/>メインエントリ]
        Login[Login.tsx]
        Dashboard[Dashboard]
    end

    subgraph "シフト関連"
        ST[ShiftTable.tsx<br/>シフト表]
        SC[ShiftCell.tsx<br/>セル]
        SM[ShiftModal.tsx<br/>編集モーダル]
    end

    subgraph "設定関連"
        STS[ShiftTypeSettings.tsx<br/>シフト種別設定]
        LBD[LeaveBalanceDashboard.tsx<br/>休暇残高]
    end

    subgraph "共通"
        Modal[Modal.tsx]
        Button[Button.tsx]
        Toast[Toast.tsx]
    end

    subgraph "Services"
        AuthS[authService.ts]
        StaffS[staffService.ts]
        ScheduleS[scheduleService.ts]
        ShiftTypeS[shiftTypeService.ts]
        LeaveBalS[leaveBalanceService.ts]
    end

    subgraph "Hooks"
        UseAuth[useAuth.ts]
        UseSchedule[useSchedule.ts]
        UseUndo[useUndoRedo.ts]
    end

    App --> Login
    App --> Dashboard
    Dashboard --> ST
    Dashboard --> STS
    Dashboard --> LBD

    ST --> SC
    ST --> SM
    ST --> Modal

    STS --> Modal
    LBD --> Modal

    ST --> ScheduleS
    STS --> ShiftTypeS
    LBD --> LeaveBalS

    App --> UseAuth
    ST --> UseSchedule
    ST --> UseUndo

    style App fill:#E3F2FD
    style ST fill:#E8F5E9
    style STS fill:#FCE4EC
    style LBD fill:#FCE4EC
        </div>

        <hr>

        <h2 id="keyboard">8. キーボード操作フロー</h2>

        <div class="mermaid">
flowchart TD
    Start([シフトセルにフォーカス])

    Start --> KeyPress{キー入力}

    KeyPress -->|Tab| NextCell[次のセルへ移動]
    KeyPress -->|Shift+Tab| PrevCell[前のセルへ移動]
    KeyPress -->|Enter| OpenModal[編集モーダル表示]
    KeyPress -->|矢印キー| ArrowNav[矢印方向へ移動]
    KeyPress -->|PageUp| PrevWeek[1週間前へ]
    KeyPress -->|PageDown| NextWeek[1週間後へ]
    KeyPress -->|Ctrl+Z| Undo[アンドゥ]
    KeyPress -->|Ctrl+Shift+Z| Redo[リドゥ]
    KeyPress -->|?| Help[ヘルプモーダル]
    KeyPress -->|ダブルクリック| CycleShift[シフトサイクル]

    NextCell --> End([操作完了])
    PrevCell --> End
    ArrowNav --> End
    PrevWeek --> End
    NextWeek --> End

    OpenModal --> Edit[シフト編集]
    Edit --> Save[保存]
    Save --> End

    Undo --> End
    Redo --> End
    Help --> CloseHelp[モーダル閉じる]
    CloseHelp --> End

    CycleShift --> End

    style Start fill:#E6F3FF
    style End fill:#90EE90
        </div>

        <h3>キーボードショートカット一覧</h3>

        <table>
            <tr>
                <th>キー</th>
                <th>動作</th>
            </tr>
            <tr>
                <td><code>Tab</code></td>
                <td>次のセルへ移動</td>
            </tr>
            <tr>
                <td><code>Shift + Tab</code></td>
                <td>前のセルへ移動</td>
            </tr>
            <tr>
                <td><code>Enter</code></td>
                <td>編集モーダルを開く</td>
            </tr>
            <tr>
                <td><code>矢印キー</code></td>
                <td>上下左右に移動</td>
            </tr>
            <tr>
                <td><code>PageUp</code></td>
                <td>1週間前へ移動</td>
            </tr>
            <tr>
                <td><code>PageDown</code></td>
                <td>1週間後へ移動</td>
            </tr>
            <tr>
                <td><code>Ctrl + Z</code></td>
                <td>アンドゥ（元に戻す）</td>
            </tr>
            <tr>
                <td><code>Ctrl + Shift + Z</code></td>
                <td>リドゥ（やり直し）</td>
            </tr>
            <tr>
                <td><code>?</code></td>
                <td>ヘルプモーダル表示</td>
            </tr>
            <tr>
                <td><code>ダブルクリック</code></td>
                <td>シフトサイクル（次のシフトへ）</td>
            </tr>
        </table>

        <hr>

        <p><a href="index.html">トップページに戻る</a></p>

        <footer class="site-footer">
            <p><strong>最終更新</strong>: 2025年11月26日（Phase 39完了時点）</p>
        </footer>
    </main>
</body>
</html>
